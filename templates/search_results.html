{% extends "loggedIn.html" %}

{% block headstuff %}
<title>Search Results</title>
{% endblock %}

{% block content %}
<div class="searchbar" style="margin-top: 20px;">
    <form method="post" action="{{ url_for('search') }}"> 
        <input id="query" name="query" type="text" placeholder="Search for a user or media..." required>
        <select id="mood" name="mood">
            <option value="">Filter mood</option>
            <option value="happy">happy</option>
            <option value="sad">sad</option>     
            <option value="angry">angry</option>  
            <option value="calm">calm</option>             
        </select>
        <select id="genre" name="genre">
            <option value="">Filter genre</option>
            <option value="action">action</option>
            <option value="comedy">comedy</option>     
            <option value="romance">romance</option>  
            <option value="horror">horror</option>             
        </select>
        <select id="audience" name="audience">
            <option value="">Filter audience</option>
            <option value="family">family</option>
            <option value="significant other">significant other</option>     
            <option value="children">children</option>  
            <option value="friends">friends</option>             
        </select>
        <select id="kind" name="kind" required>
            <option value="">Select type*</option>
            <option value="username">username</option>
            <option value="media">media type</option>                
        </select>
        <input id="search-button" type="submit" value="Search">
        <br>
    </form> 
</div>

    <!-- {# If length of search results is 0, displays that no person/movie 
        was in the database. Else, displays the search results matching 
        the query in a list with the appropriate hyperlinks #}
    {% if length == 0 %}
    <h1>Not Found</h1>
    <p>Sorry, no {{kind}} results were found</p>

    {% else %} -->
        {% if kind == "username"%}
        <h3 class="description"> Users matching "{{query}}":</h3>
        <div class="user-container">
            {% for user in search_results %}
            <div class="user-box">
                <p>{{user.name}} ({{user.username}})</p>
            </div>
            {% endfor %}
        </div>

        {% else %}
        <h3 class="description">Media matching "{{query}}":</h3>
        <div class="media-container">
            {% for media in search_results %}
            <a href="{{ url_for('media_info', mediaID=media.mediaID)}}">
                <div class="media-box">
                    <p>
                        <span class="media-title">{{media.title}} </span>
                        <span class="year tag">{{media.releaseYear}}</span> 
                        {% if media.type == 'tv' %}
                            <span class="tv tag">{{media.type}}</span>
                        {% elif media.type == 'movie' %}
                            <span class="movie tag">{{media.type}}</span>
                        {% elif media.type == 'music' %}
                            <span class="music tag">{{media.type}}</span>
                        {% elif media.type == 'game' %}
                            <span class="game tag">{{media.type}}</span>
                        {% elif media.type == 'book' %}
                            <span class="book tag">{{media.type}}</span>
                        {% endif %}
                        <!-- No creator currently found through do_search -->
                        <!-- <span class="creator tag">{{media.name}}</span> -->
                    </p>
                </div>
            </a>
            {% endfor %}
        </div>
        <article>
            <ol>
                {% for media in search_results %}
                <li><a href={{url_for('media_info', mediaID=media.mediaID)}}>{{media.title}} ({{media.releaseYear}}, {{media.type}})</a></li>
            {% endfor %}
            </ol>
        </article>
        {% endif %}
    {% endif %}
{% endblock %}